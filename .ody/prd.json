[
  {
    "category": "functional",
    "description": "Allow adding provider and model to ody.json configuration file",
    "steps": [
      "Allows `--provider` and `--model` optional arguments to init command",
      "Adds new `provider` property to configuration object if passed in",
      "Adds new `model` property to configuration object if passed in"
    ],
    "passes": true
  },
  {
    "category": "functional",
    "description": "Add new plan cli command",
    "steps": [
      "New CLI command of `ody plan`",
      "Logs to `console` with message of `To be implemented`"
    ],
    "passes": true
  },
  {
    "category": "functional",
    "description": "Prompt user for details during the plan command",
    "steps": [
      "Uses available functions from `@clack/prompts` for user input",
      "Asks for general task description",
      "Prompts for simple steps descriptions, free form text",
      "Outputs the input information to console"
    ],
    "passes": true
  },
  {
    "category": "bugfix",
    "description": "Fix maxIterations: 0 so it means infinite iterations instead of zero",
    "steps": [
      "In `src/cmd/run.ts`, update the for-loop condition to treat `0` as infinite: `for (let i = 0; maxIterations === 0 || i < maxIterations; i++)`",
      "In `src/lib/config.ts`, add `.int().nonnegative()` constraints to the `maxIterations` zod schema to prevent negative or fractional values",
      "Verify that `ody run` with `maxIterations: 0` loops until the completion marker is found, and that positive values still cap the loop correctly"
    ],
    "passes": true
  },
  {
    "category": "bugfix",
    "description": "Fix proc.kill(0) calls to properly terminate child processes and prevent zombie processes",
    "steps": [
      "In `src/cmd/run.ts` loop mode (around line 113), replace `proc.kill(0)` with `proc.kill()` (sends SIGTERM) and add `await proc.exited` after breaking out of the read loop to ensure the process is fully cleaned up",
      "In `src/cmd/run.ts` once mode (around line 67), remove the `proc.kill(exitCode)` call entirely since the process has already exited after `await proc.exited`",
      "In `src/cmd/plan.ts` (around line 123), replace `proc.kill(0)` with `proc.kill()` and add `await proc.exited` after the read loop to prevent zombie processes",
      "Verify that spawned agent processes are properly terminated when the `<woof>COMPLETE</woof>` marker is detected and no orphaned processes remain"
    ],
    "passes": true
  },
  {
    "category": "bugfix",
    "description": "Fix stderr pipe deadlock by inheriting stderr instead of piping it unread",
    "steps": [
      "In `src/cmd/run.ts`, change the stdio array from `['ignore', 'pipe', 'pipe']` to `['ignore', 'pipe', 'inherit']` so stderr flows directly to the terminal",
      "In `src/cmd/plan.ts`, change the stdio array from `['ignore', 'pipe', 'pipe']` to `['ignore', 'pipe', 'inherit']` so stderr flows directly to the terminal",
      "Verify that agent error output is visible in the terminal and that long-running agents no longer risk deadlocking on a full stderr buffer"
    ],
    "passes": true
  },
  {
    "category": "bugfix",
    "description": "Fix silent swallowing of non-Error exceptions in catch blocks",
    "steps": [
      "In `src/lib/config.ts` (catch block around line 43), add an else branch after the `Error.isError(err)` check that logs the stringified error and calls `process.exit(1)`",
      "In `src/cmd/init.ts` (catch block around line 152), add an else branch that logs the unknown error and calls `process.exit(1)`",
      "In `src/cmd/run.ts` (catch blocks around lines 70 and 119), add else branches that log the unknown error and call `process.exit(1)`",
      "Verify that thrown strings, objects, or ZodError instances are properly caught, logged, and cause a non-zero exit"
    ],
    "passes": true
  },
  {
    "category": "improvement",
    "description": "Make Claude backend's --dangerously-skip-permissions flag configurable",
    "steps": [
      "Add a new optional boolean config key `skipPermissions` to the zod schema in `src/lib/config.ts`, defaulting to `true` to preserve current behavior",
      "Add a prompt during `ody init` asking whether to skip permission checks, with a note that this bypasses Claude Code's safety system",
      "In `src/backends/claude.ts`, conditionally include `--dangerously-skip-permissions` only when `skipPermissions` is `true`",
      "Verify that setting `skipPermissions: false` in `.ody/ody.json` omits the flag from the spawned Claude command"
    ],
    "passes": true
  },
  {
    "category": "feature",
    "description": "Log stderr output when verbose flag is used in run command",
    "steps": [
      "Add a `--verbose` flag argument to the run command in `src/cmd/run.ts`",
      "Change stderr stdio from `'inherit'` to `'pipe'` when verbose is enabled",
      "Read stderr stream from the spawned process and log each line via `logger` when verbose is true",
      "Ensure stderr logging does not interfere with stdout completion marker detection",
      "Verify that stderr output appears in terminal only when `--verbose` is passed"
    ],
    "passes": false
  },
  {
    "category": "feature",
    "description": "Prompt to add another plan after each iteration in plan command",
    "steps": [
      "After plan creation completes, prompt user with a yes/no confirm using `@clack/prompts`",
      "If user confirms yes, restart the plan prompting flow from the beginning",
      "If user declines, exit the plan command gracefully",
      "Wrap the plan flow in a loop that continues until user declines"
    ],
    "passes": false
  },
  {
    "category": "feature",
    "description": "Log stderr output when verbose flag is used in plan command",
    "steps": [
      "Change stderr stdio from `'inherit'` to `'pipe'` in `src/cmd/plan.ts` spawn call",
      "Read stderr stream from the spawned process alongside stdout when verbose is enabled",
      "Log each stderr chunk via `logger` or `log.message` when verbose is true",
      "Keep stderr as `'inherit'` (or silenced) when verbose is false to preserve current behavior",
      "Ensure stderr reading does not interfere with stdout completion marker detection"
    ],
    "passes": false
  }
]
